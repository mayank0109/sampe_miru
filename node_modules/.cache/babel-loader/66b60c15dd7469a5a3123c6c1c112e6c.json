{"ast":null,"code":"var _jsxFileName = \"/Users/mayankkhanna/Documents/miru-web/app/javascript/src/components/timesheet-entry/AddEntry.tsx\",\n    _this = this;\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar logger = require(\"js-logger\").get(\":javascript:src:components:timesheet-entry:AddEntry.tsx\");\n\nimport * as React from \"react\";\nimport timesheetEntryApi from \"../../apis/timesheet-entry\";\nimport { minutesFromHHMM, minutesToHHMM } from \"../../helpers/hhmm-parser\";\nimport { getNumberWithOrdinal } from \"../../helpers/ordinal\";\n\nvar AddEntry = function AddEntry(_ref) {\n  var setNewEntryView = _ref.setNewEntryView,\n      clients = _ref.clients,\n      projects = _ref.projects,\n      selectedDateInfo = _ref.selectedDateInfo,\n      setEntryList = _ref.setEntryList,\n      entryList = _ref.entryList,\n      selectedFullDate = _ref.selectedFullDate,\n      setEditEntryId = _ref.setEditEntryId,\n      editEntryId = _ref.editEntryId;\n  var useState = React.useState,\n      useEffect = React.useEffect;\n  clients = clients.sort(function (a, b) {\n    return a.name < b.name ? -1 : 1;\n  });\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      note = _useState2[0],\n      setNote = _useState2[1];\n\n  var _useState3 = useState(\"00:00\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      duration = _useState4[0],\n      setDuration = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      client = _useState6[0],\n      setClient = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      project = _useState8[0],\n      setProject = _useState8[1];\n\n  useEffect(function () {\n    if (editEntryId) {\n      var entry = entryList[selectedFullDate].filter(function (entry) {\n        return entry.id === editEntryId;\n      })[0];\n\n      if (entry) {\n        setNote(entry.note);\n        setDuration(minutesToHHMM(entry.duration));\n        setClient(entry.client);\n        setProject(entry.project);\n      }\n    }\n  }, []);\n\n  var handleDurationChange = function handleDurationChange(e) {\n    var v = e.target.value;\n\n    var _v$split = v.split(\":\"),\n        _v$split2 = _slicedToArray(_v$split, 2),\n        hh = _v$split2[0],\n        mm = _v$split2[1];\n\n    if (Number(hh) > 24) hh = \"00\";\n    if (Number(mm) > 59) mm = \"00\";\n    v = \"\".concat(hh, \":\").concat(mm);\n    setDuration(v);\n  };\n\n  var handleSave = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _res$data;\n\n      var entry, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(!note && !project)) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              entry = {\n                work_date: selectedFullDate,\n                duration: minutesFromHHMM(duration),\n                note: note\n              };\n              _context.next = 5;\n              return timesheetEntryApi.create({\n                project_name: project,\n                timesheet_entry: entry\n              });\n\n            case 5:\n              res = _context.sent;\n\n              if ((_res$data = res.data) !== null && _res$data !== void 0 && _res$data.success) {\n                setEntryList(function (pv) {\n                  var newState = _objectSpread({}, pv);\n\n                  if (pv[selectedFullDate]) {\n                    newState[selectedFullDate] = [res.data.entry].concat(_toConsumableArray(pv[selectedFullDate]));\n                  } else {\n                    newState[selectedFullDate] = [res.data.entry];\n                  }\n\n                  return newState;\n                });\n                setNewEntryView(false);\n              }\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSave() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleEdit = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _res$data2;\n\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return timesheetEntryApi.update(editEntryId, {\n                project_name: project,\n                timesheet_entry: {\n                  note: note,\n                  duration: minutesFromHHMM(duration),\n                  work_date: selectedFullDate\n                }\n              });\n\n            case 2:\n              res = _context2.sent;\n\n              if ((_res$data2 = res.data) !== null && _res$data2 !== void 0 && _res$data2.success) {\n                setEntryList(function (pv) {\n                  var newState = _objectSpread({}, pv);\n\n                  newState[selectedFullDate] = pv[selectedFullDate].map(function (entry) {\n                    if (entry.id === editEntryId) {\n                      return res.data.entry;\n                    }\n\n                    return entry;\n                  });\n                  return newState;\n                });\n                setNewEntryView(false);\n                setEditEntryId(0);\n              }\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleEdit() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"h-24 py-1 flex justify-evenly rounded-lg shadow-2xl \" + (editEntryId === 0 ? \"\" : \"mt-10\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"w-60 ml-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    onChange: function onChange(e) {\n      setClient(e.target.value);\n      setProject(projects[e.target.value][0].name);\n    },\n    name: \"client\",\n    id: \"client\",\n    className: \"w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }\n  }, !client && /*#__PURE__*/React.createElement(\"option\", {\n    disabled: true,\n    selected: true,\n    className: \"text-miru-gray-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, \"Client\"), clients.map(function (c, i) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: i.toString(),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }\n    }, c.name);\n  })), /*#__PURE__*/React.createElement(\"select\", {\n    onChange: function onChange(e) {\n      return setProject(e.target.value);\n    },\n    name: \"project\",\n    id: \"project\",\n    className: \"w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, !project && /*#__PURE__*/React.createElement(\"option\", {\n    disabled: true,\n    selected: true,\n    className: \"text-miru-gray-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, \"Project\"), client && projects[client].map(function (p, i) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: i.toString(),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 15\n      }\n    }, p.name);\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mx-10\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"textarea\", {\n    value: note,\n    onChange: function onChange(e) {\n      return setNote(e.target.value);\n    },\n    rows: 5,\n    cols: 60,\n    name: \"notes\",\n    placeholder: \" Notes\",\n    className: \"w-60 h-18 rounded-sm bg-miru-gray-100 my-2\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-60\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"p-1 w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, \"\".concat(getNumberWithOrdinal(selectedDateInfo[\"date\"]), \" \").concat(selectedDateInfo[\"month\"], \", \").concat(selectedDateInfo[\"year\"])), /*#__PURE__*/React.createElement(\"input\", {\n    value: duration,\n    onChange: handleDurationChange,\n    type: \"text\",\n    className: \"w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mr-4 my-2 ml-14\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }\n  }, editEntryId === 0 ? /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleSave,\n    className: \"mb-1 h-8 w-38 text-xs py-1 px-6 rounded border text-white font-bold \" + (note && client && project ? \"bg-miru-han-purple-1000 hover:border-transparent\" : \"bg-miru-gray-1000\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 11\n    }\n  }, \"SAVE\") : /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      return handleEdit();\n    },\n    className: \"mb-1 h-8 w-38 text-xs py-1 px-6 rounded border text-white font-bold \" + (note && client && project ? \"bg-miru-han-purple-1000 hover:border-transparent\" : \"bg-miru-gray-1000\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 11\n    }\n  }, \"UPDATE\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      setNewEntryView(false);\n      setEditEntryId(0);\n    },\n    className: \"mt-1 h-8 w-38 text-xs py-1 px-6 rounded border border-miru-han-purple-1000 bg-transparent hover:bg-miru-han-purple-1000 text-miru-han-purple-600 font-bold hover:text-white hover:border-transparent\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 9\n    }\n  }, \"CANCEL\")));\n};\n\nexport default AddEntry;","map":{"version":3,"sources":["/Users/mayankkhanna/Documents/miru-web/app/javascript/src/components/timesheet-entry/AddEntry.tsx"],"names":["React","timesheetEntryApi","minutesFromHHMM","minutesToHHMM","getNumberWithOrdinal","AddEntry","setNewEntryView","clients","projects","selectedDateInfo","setEntryList","entryList","selectedFullDate","setEditEntryId","editEntryId","useState","useEffect","sort","a","b","name","note","setNote","duration","setDuration","client","setClient","project","setProject","entry","filter","id","handleDurationChange","e","v","target","value","split","hh","mm","Number","handleSave","work_date","create","project_name","timesheet_entry","res","data","success","pv","newState","handleEdit","update","map","c","i","toString","p"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport timesheetEntryApi from \"../../apis/timesheet-entry\";\nimport { minutesFromHHMM, minutesToHHMM } from \"../../helpers/hhmm-parser\";\nimport { getNumberWithOrdinal } from \"../../helpers/ordinal\";\n\ninterface props {\n  setNewEntryView: React.Dispatch<React.SetStateAction<boolean>>;\n  clients: client[];\n  projects: object;\n  selectedDateInfo: object;\n  setEntryList: React.Dispatch<React.SetStateAction<object[]>>;\n  entryList: object;\n  selectedFullDate: string;\n  editEntryId: number;\n  setEditEntryId: React.Dispatch<React.SetStateAction<number>>;\n}\n\ninterface client {\n  name: string;\n}\n\nconst AddEntry: React.FC<props> = ({\n  setNewEntryView,\n  clients,\n  projects,\n  selectedDateInfo,\n  setEntryList,\n  entryList,\n  selectedFullDate,\n  setEditEntryId,\n  editEntryId\n}) => {\n  const { useState, useEffect } = React;\n  clients = clients.sort((a, b) => (a.name < b.name ? -1 : 1));\n  const [note, setNote] = useState(\"\");\n  const [duration, setDuration] = useState(\"00:00\");\n  const [client, setClient] = useState(\"\");\n  const [project, setProject] = useState(\"\");\n\n  useEffect(() => {\n    if (editEntryId) {\n      const entry = entryList[selectedFullDate].filter(\n        entry => entry.id === editEntryId\n      )[0];\n      if (entry) {\n        setNote(entry.note);\n        setDuration(minutesToHHMM(entry.duration));\n        setClient(entry.client);\n        setProject(entry.project);\n      }\n    }\n  }, []);\n\n  const handleDurationChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    let v = e.target.value;\n    let [hh, mm] = v.split(\":\");\n    if (Number(hh) > 24) hh = \"00\";\n    if (Number(mm) > 59) mm = \"00\";\n    v = `${hh}:${mm}`;\n    setDuration(v);\n  };\n\n  const handleSave = async () => {\n    if (!note && !project) return;\n    const entry = {\n      work_date: selectedFullDate,\n      duration: minutesFromHHMM(duration),\n      note: note\n    };\n\n    const res = await timesheetEntryApi.create({\n      project_name: project,\n      timesheet_entry: entry\n    });\n\n    if (res.data?.success) {\n      setEntryList(pv => {\n        const newState = { ...pv };\n        if (pv[selectedFullDate]) {\n          newState[selectedFullDate] = [\n            res.data.entry,\n            ...pv[selectedFullDate]\n          ];\n        } else {\n          newState[selectedFullDate] = [res.data.entry];\n        }\n        return newState;\n      });\n\n      setNewEntryView(false);\n    }\n  };\n\n  const handleEdit = async () => {\n    const res = await timesheetEntryApi.update(editEntryId, {\n      project_name: project,\n      timesheet_entry: {\n        note: note,\n        duration: minutesFromHHMM(duration),\n        work_date: selectedFullDate\n      }\n    });\n    if (res.data?.success) {\n      setEntryList(pv => {\n        const newState = { ...pv };\n        newState[selectedFullDate] = pv[selectedFullDate].map(entry => {\n          if (entry.id === editEntryId) {\n            return res.data.entry;\n          }\n          return entry;\n        });\n        return newState;\n      });\n      setNewEntryView(false);\n      setEditEntryId(0);\n    }\n  };\n\n  return (\n    <div\n      className={\n        \"h-24 py-1 flex justify-evenly rounded-lg shadow-2xl \" +\n        (editEntryId === 0 ? \"\" : \"mt-10\")\n      }\n    >\n      <span className=\"w-60 ml-4\">\n        <select\n          onChange={e => {\n            setClient(e.target.value);\n            setProject(projects[e.target.value][0].name);\n          }}\n          name=\"client\"\n          id=\"client\"\n          className=\"w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\"\n        >\n          {!client && (\n            <option disabled selected className=\"text-miru-gray-100\">\n              Client\n            </option>\n          )}\n          {clients.map((c, i) => (\n            <option key={i.toString()}>{c.name}</option>\n          ))}\n        </select>\n\n        <select\n          onChange={e => setProject(e.target.value)}\n          name=\"project\"\n          id=\"project\"\n          className=\"w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\"\n        >\n          {!project && (\n            <option disabled selected className=\"text-miru-gray-100\">\n              Project\n            </option>\n          )}\n          {client &&\n            projects[client].map((p, i) => (\n              <option key={i.toString()}>{p.name}</option>\n            ))}\n        </select>\n      </span>\n      <div className=\"mx-10\">\n        <textarea\n          value={note}\n          onChange={e => setNote(e.target.value)}\n          rows={5}\n          cols={60}\n          name=\"notes\"\n          placeholder=\" Notes\"\n          className=\"w-60 h-18 rounded-sm bg-miru-gray-100 my-2\"\n        ></textarea>\n      </div>\n      <div className=\"w-60\">\n        <div className=\"p-1 w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\">\n          {`${getNumberWithOrdinal(selectedDateInfo[\"date\"])} ${\n            selectedDateInfo[\"month\"]\n          }, ${selectedDateInfo[\"year\"]}`}\n        </div>\n        <input\n          value={duration}\n          onChange={handleDurationChange}\n          type=\"text\"\n          className=\"w-60 bg-miru-gray-100 rounded-sm mt-2 h-8\"\n        />\n      </div>\n      <div className=\"mr-4 my-2 ml-14\">\n        {editEntryId === 0 ? (\n          <button\n            onClick={handleSave}\n            className={\n              \"mb-1 h-8 w-38 text-xs py-1 px-6 rounded border text-white font-bold \" +\n              (note && client && project\n                ? \"bg-miru-han-purple-1000 hover:border-transparent\"\n                : \"bg-miru-gray-1000\")\n            }\n          >\n            SAVE\n          </button>\n        ) : (\n          <button\n            onClick={() => handleEdit()}\n            className={\n              \"mb-1 h-8 w-38 text-xs py-1 px-6 rounded border text-white font-bold \" +\n              (note && client && project\n                ? \"bg-miru-han-purple-1000 hover:border-transparent\"\n                : \"bg-miru-gray-1000\")\n            }\n          >\n            UPDATE\n          </button>\n        )}\n        <button\n          onClick={() => {\n            setNewEntryView(false);\n            setEditEntryId(0);\n          }}\n          className=\"mt-1 h-8 w-38 text-xs py-1 px-6 rounded border border-miru-han-purple-1000 bg-transparent hover:bg-miru-han-purple-1000 text-miru-han-purple-600 font-bold hover:text-white hover:border-transparent\"\n        >\n          CANCEL\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default AddEntry;\n"]},"metadata":{},"sourceType":"module"}