{"ast":null,"code":"var _jsxFileName = \"/Users/mayankkhanna/Documents/miru-web/app/javascript/src/components/Invoices/Generate/index.tsx\",\n    _this = this;\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar logger = require(\"js-logger\").get(\"@saeloun/miru-web:javascript:src:components:Invoices:Generate:index.tsx\");\n\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { setAuthHeaders, registerIntercepts } from \"apis/axios\";\nimport generateInvoice from \"apis/generateInvoice\";\nimport invoicesApi from \"apis/invoices\";\nimport Toastr from \"common/Toastr\";\nimport Container from \"./Container\";\nimport Header from \"./Header\";\nimport Invoice_settings from \"./Invoice_settings\";\nimport { mapGenerateInvoice, unmapGenerateInvoice } from \"../../../mapper/generateInvoice.mapper\";\nimport SendInvoice from \"../popups/SendInvoice\";\n\nvar GenerateInvoices = function GenerateInvoices() {\n  var navigate = useNavigate();\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      invoiceDetails = _useState2[0],\n      getInvoiceDetails = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      lineItems = _useState4[0],\n      setLineItems = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      selectedClient = _useState6[0],\n      setSelectedClient = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      invoiceNumber = _useState8[0],\n      setInvoiceNumber = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 1),\n      reference = _useState10[0];\n\n  var _useState11 = useState(0),\n      _useState12 = _slicedToArray(_useState11, 2),\n      amount = _useState12[0],\n      setAmount = _useState12[1];\n\n  var _useState13 = useState(0),\n      _useState14 = _slicedToArray(_useState13, 2),\n      amountDue = _useState14[0],\n      setAmountDue = _useState14[1];\n\n  var _useState15 = useState(0),\n      _useState16 = _slicedToArray(_useState15, 1),\n      amountPaid = _useState16[0];\n\n  var _useState17 = useState(0),\n      _useState18 = _slicedToArray(_useState17, 2),\n      discount = _useState18[0],\n      setDiscount = _useState18[1];\n\n  var _useState19 = useState(0),\n      _useState20 = _slicedToArray(_useState19, 2),\n      tax = _useState20[0],\n      setTax = _useState20[1];\n\n  var _useState21 = useState(new Date()),\n      _useState22 = _slicedToArray(_useState21, 2),\n      issueDate = _useState22[0],\n      setIssueDate = _useState22[1];\n\n  var today = new Date();\n\n  var _useState23 = useState(today.setMonth(issueDate.getMonth() + 1)),\n      _useState24 = _slicedToArray(_useState23, 2),\n      dueDate = _useState24[0],\n      setDueDate = _useState24[1];\n\n  var _useState25 = useState([]),\n      _useState26 = _slicedToArray(_useState25, 2),\n      selectedOption = _useState26[0],\n      setSelectedOption = _useState26[1];\n\n  var _useState27 = useState(false),\n      _useState28 = _slicedToArray(_useState27, 2),\n      showSendInvoiceModal = _useState28[0],\n      setShowSendInvoiceModal = _useState28[1];\n\n  var _useState29 = useState(null),\n      _useState30 = _slicedToArray(_useState29, 2),\n      invoiceId = _useState30[0],\n      setInvoiceId = _useState30[1];\n\n  var _useState31 = useState(true),\n      _useState32 = _slicedToArray(_useState31, 2),\n      showInvoiceSetting = _useState32[0],\n      setShowInvoiceSetting = _useState32[1];\n\n  var fetchGenerateInvoice = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(navigate, getInvoiceDetails) {\n      var res, sanitzed;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return generateInvoice.get();\n\n            case 3:\n              res = _context.sent;\n              _context.next = 6;\n              return unmapGenerateInvoice(res.data);\n\n            case 6:\n              sanitzed = _context.sent;\n              getInvoiceDetails(sanitzed);\n              _context.next = 14;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              navigate(\"invoices/error\");\n              return _context.abrupt(\"return\", {});\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 10]]);\n    }));\n\n    return function fetchGenerateInvoice(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    setAuthHeaders();\n    registerIntercepts();\n    fetchGenerateInvoice(navigate, getInvoiceDetails);\n  }, []);\n\n  var saveInvoice = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var sanitized;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              sanitized = mapGenerateInvoice({\n                selectedClient: selectedClient,\n                invoiceNumber: invoiceNumber,\n                reference: reference,\n                issueDate: issueDate,\n                dueDate: dueDate,\n                selectedOption: selectedOption,\n                amount: amount,\n                amountDue: amountDue,\n                amountPaid: amountPaid,\n                discount: discount,\n                tax: tax,\n                setShowSendInvoiceModal: setShowSendInvoiceModal\n              });\n              _context2.next = 3;\n              return invoicesApi.post(sanitized);\n\n            case 3:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function saveInvoice() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleSendInvoice = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (selectedClient && invoiceNumber !== \"\") {\n                saveInvoice().then(function (resp) {\n                  setShowSendInvoiceModal(true);\n                  setInvoiceId(resp.data.id);\n                });\n              } else {\n                Toastr.error(\"Please select client and enter invoice number to proceed.\");\n              }\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleSendInvoice() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleSaveInvoice = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (selectedClient && invoiceNumber !== \"\") {\n                saveInvoice().then(function () {\n                  return navigate(\"/invoices\");\n                });\n              } else {\n                Toastr.error(\"Please select client and enter invoice number to proceed.\");\n              }\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function handleSaveInvoice() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  if (invoiceDetails) {\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      handleSendInvoice: handleSendInvoice,\n      handleSaveInvoice: handleSaveInvoice,\n      setShowInvoiceSetting: setShowInvoiceSetting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Container, {\n      invoiceDetails: invoiceDetails,\n      selectedClient: selectedClient,\n      setSelectedClient: setSelectedClient,\n      lineItems: lineItems,\n      setLineItems: setLineItems,\n      invoiceNumber: invoiceNumber,\n      setInvoiceNumber: setInvoiceNumber,\n      reference: reference,\n      issueDate: issueDate,\n      setIssueDate: setIssueDate,\n      dueDate: dueDate,\n      setDueDate: setDueDate,\n      amount: amount,\n      setAmount: setAmount,\n      amountDue: amountDue,\n      setAmountDue: setAmountDue,\n      amountPaid: amountPaid,\n      discount: discount,\n      setDiscount: setDiscount,\n      tax: tax,\n      setTax: setTax,\n      selectedOption: selectedOption,\n      setSelectedOption: setSelectedOption,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }), showSendInvoiceModal && /*#__PURE__*/React.createElement(SendInvoice, {\n      invoice: {\n        id: invoiceId,\n        client: selectedClient,\n        company: invoiceDetails === null || invoiceDetails === void 0 ? void 0 : invoiceDetails.companyDetails,\n        invoiceNumber: invoiceNumber,\n        amount: amount\n      },\n      isSending: showSendInvoiceModal,\n      setIsSending: setShowSendInvoiceModal,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 34\n      }\n    }), showInvoiceSetting && /*#__PURE__*/React.createElement(Invoice_settings, {\n      setShowInvoiceSetting: setShowInvoiceSetting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null);\n};\n\nexport default GenerateInvoices;","map":{"version":3,"sources":["/Users/mayankkhanna/Documents/miru-web/app/javascript/src/components/Invoices/Generate/index.tsx"],"names":["React","useEffect","useState","useNavigate","setAuthHeaders","registerIntercepts","generateInvoice","invoicesApi","Toastr","Container","Header","Invoice_settings","mapGenerateInvoice","unmapGenerateInvoice","SendInvoice","GenerateInvoices","navigate","invoiceDetails","getInvoiceDetails","lineItems","setLineItems","selectedClient","setSelectedClient","invoiceNumber","setInvoiceNumber","reference","amount","setAmount","amountDue","setAmountDue","amountPaid","discount","setDiscount","tax","setTax","Date","issueDate","setIssueDate","today","setMonth","getMonth","dueDate","setDueDate","selectedOption","setSelectedOption","showSendInvoiceModal","setShowSendInvoiceModal","invoiceId","setInvoiceId","showInvoiceSetting","setShowInvoiceSetting","fetchGenerateInvoice","get","res","data","sanitzed","saveInvoice","sanitized","post","handleSendInvoice","then","resp","id","error","handleSaveInvoice","client","company","companyDetails"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport { useNavigate } from \"react-router-dom\";\nimport { setAuthHeaders, registerIntercepts } from \"apis/axios\";\nimport generateInvoice from \"apis/generateInvoice\";\n\nimport invoicesApi from \"apis/invoices\";\nimport Toastr from \"common/Toastr\";\nimport Container from \"./Container\";\nimport Header from \"./Header\";\n\nimport Invoice_settings from \"./Invoice_settings\";\nimport { mapGenerateInvoice, unmapGenerateInvoice } from \"../../../mapper/generateInvoice.mapper\";\nimport SendInvoice from \"../popups/SendInvoice\";\n\nconst GenerateInvoices = () => {\n  const navigate = useNavigate();\n  const [invoiceDetails, getInvoiceDetails] = useState<any>();\n  const [lineItems, setLineItems] = useState<any>([]);\n  const [selectedClient, setSelectedClient] = useState<any>();\n  const [invoiceNumber, setInvoiceNumber] = useState<any>(\"\");\n  const [reference] = useState<any>(\"\");\n  const [amount, setAmount] = useState<any>(0);\n  const [amountDue, setAmountDue] = useState<any>(0);\n  const [amountPaid] = useState<any>(0);\n  const [discount, setDiscount] = useState<any>(0);\n  const [tax, setTax] = useState<any>(0);\n  const [issueDate, setIssueDate] = useState(new Date());\n  const today = new Date();\n  const [dueDate, setDueDate] = useState(today.setMonth(issueDate.getMonth() + 1));\n  const [selectedOption, setSelectedOption] = useState<any>([]);\n  const [showSendInvoiceModal, setShowSendInvoiceModal] = useState<boolean>(false);\n  const [invoiceId, setInvoiceId] = useState<number>(null);\n  const [showInvoiceSetting, setShowInvoiceSetting] = useState<boolean>(true);\n\n  const fetchGenerateInvoice = async (navigate, getInvoiceDetails) => {\n    try {\n      const res = await generateInvoice.get();\n      const sanitzed = await unmapGenerateInvoice(res.data);\n      getInvoiceDetails(sanitzed);\n    } catch (e) {\n      navigate(\"invoices/error\");\n      return {};\n    }\n  };\n\n  useEffect(() => {\n    setAuthHeaders();\n    registerIntercepts();\n    fetchGenerateInvoice(navigate, getInvoiceDetails);\n  }, []);\n\n  const saveInvoice = async () => {\n    const sanitized = mapGenerateInvoice({\n      selectedClient,\n      invoiceNumber,\n      reference,\n      issueDate,\n      dueDate,\n      selectedOption,\n      amount,\n      amountDue,\n      amountPaid,\n      discount,\n      tax,\n      setShowSendInvoiceModal\n    });\n    return await invoicesApi.post(sanitized);\n  };\n\n  const handleSendInvoice = async () => {\n    if (selectedClient && invoiceNumber !== \"\") {\n      saveInvoice().then(resp => {\n        setShowSendInvoiceModal(true);\n        setInvoiceId(resp.data.id);\n      });\n    }\n    else {\n      Toastr.error(\"Please select client and enter invoice number to proceed.\");\n    }\n  };\n\n  const handleSaveInvoice = async () => {\n    if (selectedClient && invoiceNumber !== \"\") {\n      saveInvoice().then(() => navigate(\"/invoices\"));\n    } else {\n      Toastr.error(\"Please select client and enter invoice number to proceed.\");\n    }\n  };\n\n  if (invoiceDetails) {\n    return (\n      <React.Fragment>\n        <Header\n          handleSendInvoice={handleSendInvoice}\n          handleSaveInvoice={handleSaveInvoice}\n          setShowInvoiceSetting={setShowInvoiceSetting}\n        />\n        <Container\n          invoiceDetails={invoiceDetails}\n          selectedClient={selectedClient}\n          setSelectedClient={setSelectedClient}\n          lineItems={lineItems}\n          setLineItems={setLineItems}\n          invoiceNumber={invoiceNumber}\n          setInvoiceNumber={setInvoiceNumber}\n          reference={reference}\n          issueDate={issueDate}\n          setIssueDate={setIssueDate}\n          dueDate={dueDate}\n          setDueDate={setDueDate}\n          amount={amount}\n          setAmount={setAmount}\n          amountDue={amountDue}\n          setAmountDue={setAmountDue}\n          amountPaid={amountPaid}\n          discount={discount}\n          setDiscount={setDiscount}\n          tax={tax}\n          setTax={setTax}\n          selectedOption={selectedOption}\n          setSelectedOption={setSelectedOption}\n        />\n\n        {showSendInvoiceModal && <SendInvoice invoice={{\n          id: invoiceId,\n          client: selectedClient,\n          company: invoiceDetails?.companyDetails,\n          invoiceNumber,\n          amount\n        }}\n        isSending={showSendInvoiceModal}\n        setIsSending={setShowSendInvoiceModal}\n        />}\n\n        {showInvoiceSetting && (\n          <Invoice_settings\n            setShowInvoiceSetting={setShowInvoiceSetting}\n          />\n        )}\n      </React.Fragment>\n    );\n  }\n  return <></>;\n};\n\nexport default GenerateInvoices;\n"]},"metadata":{},"sourceType":"module"}