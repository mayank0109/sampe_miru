{"ast":null,"code":"var _jsxFileName = \"/app/app/javascript/src/components/Invoices/MultipleEntriesModal/index.tsx\",\n    _this = this;\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar logger = require(\"js-logger\").get(\"@saeloun/miru-web:javascript:src:components:Invoices:MultipleEntriesModal:index.tsx\");\n\nimport React, { useEffect, useState } from \"react\";\nimport dayjs from \"dayjs\";\nimport Footer from \"./Footer\";\nimport Header from \"./Header\";\nimport Table from \"./Table\";\nimport fetchNewLineItems from \"../api/generateInvoice\";\n\nvar MultipleEntriesModal = function MultipleEntriesModal(_ref) {\n  var selectedClient = _ref.selectedClient,\n      setSelectedOption = _ref.setSelectedOption,\n      selectedOption = _ref.selectedOption,\n      setMultiLineItemModal = _ref.setMultiLineItemModal;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      lineItems = _useState2[0],\n      setLineItems = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      totalLineItems = _useState4[0],\n      setTotalLineItems = _useState4[1];\n\n  var _useState5 = useState(1),\n      _useState6 = _slicedToArray(_useState5, 2),\n      pageNumber = _useState6[0],\n      setPageNumber = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      selectedLineItem = _useState8[0],\n      setSelectedLineItem = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      allCheckboxSelected = _useState10[0],\n      setAllCheckboxSelected = _useState10[1];\n\n  var handleItemSelection = function handleItemSelection(id) {\n    var checkboxes = lineItems.map(function (item) {\n      if (item.timesheet_entry_id === id) {\n        if (item.checked) {\n          var selectedItem = selectedLineItem.filter(function (lineItem) {\n            return lineItem.timesheet_entry_id !== item.timesheet_entry_id;\n          });\n          setSelectedLineItem(selectedItem);\n          setAllCheckboxSelected(false);\n          return _objectSpread(_objectSpread({}, item), {}, {\n            checked: false\n          });\n        } else {\n          setSelectedLineItem([].concat(_toConsumableArray(selectedLineItem), [item]));\n          return _objectSpread(_objectSpread({}, item), {}, {\n            checked: true\n          });\n        }\n      }\n\n      return item;\n    });\n    setLineItems(checkboxes);\n  };\n\n  var handleSelectAll = function handleSelectAll(e) {\n    var checkedLineItems = lineItems.map(function (item) {\n      return _objectSpread(_objectSpread({}, item), {}, {\n        checked: e.target.checked\n      });\n    });\n\n    if (e.target.checked) {\n      setSelectedLineItem(lineItems);\n    } else {\n      setSelectedLineItem([]);\n    }\n\n    setLineItems(checkedLineItems);\n    setAllCheckboxSelected(e.target.checked);\n  };\n\n  useEffect(function () {\n    fetchNewLineItems(selectedClient, pageNumber, selectedOption).then( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(res) {\n        var items, mergedItems, sortedData;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                setTotalLineItems(res.data.pagy.count);\n                setPageNumber(pageNumber + 1);\n                items = res.data.new_line_item_entries.map(function (item) {\n                  return _objectSpread(_objectSpread({}, item), {}, {\n                    checked: allCheckboxSelected,\n                    lineTotal: Number(item.qty) / 60 * Number(item.rate)\n                  });\n                });\n                mergedItems = [].concat(_toConsumableArray(items), _toConsumableArray(lineItems));\n                sortedData = mergedItems.sort(function (item1, item2) {\n                  return dayjs(item1.date).isAfter(dayjs(item2.date)) ? 1 : -1;\n                });\n                setLineItems(sortedData);\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  }, []);\n\n  var loadMore = function loadMore() {\n    fetchNewLineItems(selectedClient, pageNumber, selectedOption).then( /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res) {\n        var items, mergedItems, sortedData;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                setTotalLineItems(res.data.pagy.count);\n                setPageNumber(pageNumber + 1);\n                items = res.data.new_line_item_entries.map(function (item) {\n                  return _objectSpread(_objectSpread({}, item), {}, {\n                    checked: allCheckboxSelected,\n                    lineTotal: Number(item.qty) / 60 * Number(item.rate)\n                  });\n                });\n                mergedItems = [].concat(_toConsumableArray(items), _toConsumableArray(lineItems));\n                sortedData = mergedItems.sort(function (item1, item2) {\n                  return dayjs(item1.date).isAfter(dayjs(item2.date)) ? 1 : -1;\n                });\n                setLineItems(sortedData);\n\n                if (allCheckboxSelected) {\n                  setSelectedLineItem(lineItems);\n                }\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n  };\n\n  var handleSubmitModal = function handleSubmitModal() {\n    if (selectedLineItem.length > 0) {\n      setSelectedOption([].concat(_toConsumableArray(selectedOption), _toConsumableArray(selectedLineItem)));\n      setMultiLineItemModal(false);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      background: \"rgba(29, 26, 49,0.6)\"\n    },\n    className: \"px-52 py-20 w-full h-full fixed inset-0 flex justify-center z-50\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-white rounded-lg w-full h-128 flex flex-col justify-between\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    setMultiLineItemModal: setMultiLineItemModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mx-6\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }, lineItems.length > 0 && /*#__PURE__*/React.createElement(Table, {\n    lineItems: lineItems,\n    loadMore: loadMore,\n    totalLineItems: totalLineItems,\n    pageNumber: pageNumber,\n    handleItemSelection: handleItemSelection,\n    handleSelectAll: handleSelectAll,\n    allCheckboxSelected: allCheckboxSelected,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 36\n    }\n  })), /*#__PURE__*/React.createElement(Footer, {\n    selectedRowCount: selectedLineItem.length,\n    handleSubmitModal: handleSubmitModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default MultipleEntriesModal;","map":{"version":3,"sources":["/app/app/javascript/src/components/Invoices/MultipleEntriesModal/index.tsx"],"names":["React","useEffect","useState","dayjs","Footer","Header","Table","fetchNewLineItems","MultipleEntriesModal","selectedClient","setSelectedOption","selectedOption","setMultiLineItemModal","lineItems","setLineItems","totalLineItems","setTotalLineItems","pageNumber","setPageNumber","selectedLineItem","setSelectedLineItem","allCheckboxSelected","setAllCheckboxSelected","handleItemSelection","id","checkboxes","map","item","timesheet_entry_id","checked","selectedItem","filter","lineItem","handleSelectAll","e","checkedLineItems","target","then","res","data","pagy","count","items","new_line_item_entries","lineTotal","Number","qty","rate","mergedItems","sortedData","sort","item1","item2","date","isAfter","loadMore","handleSubmitModal","length","background"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport dayjs from \"dayjs\";\nimport Footer from \"./Footer\";\nimport Header from \"./Header\";\nimport Table from \"./Table\";\nimport fetchNewLineItems from \"../api/generateInvoice\";\n\nconst MultipleEntriesModal = ({\n  selectedClient,\n  setSelectedOption,\n  selectedOption,\n  setMultiLineItemModal\n}) => {\n\n  const [lineItems, setLineItems] = useState<any>([]);\n  const [totalLineItems, setTotalLineItems] = useState<number>(null);\n  const [pageNumber, setPageNumber] = useState<number>(1);\n  const [selectedLineItem, setSelectedLineItem] = useState<any>([]);\n  const [allCheckboxSelected, setAllCheckboxSelected] = useState<boolean>(false);\n\n  const handleItemSelection = (id) => {\n    const checkboxes = lineItems.map(item => {\n      if (item.timesheet_entry_id === id) {\n        if (item.checked) {\n          const selectedItem = selectedLineItem.filter(lineItem => lineItem.timesheet_entry_id !== item.timesheet_entry_id);\n          setSelectedLineItem(selectedItem);\n          setAllCheckboxSelected(false);\n          return { ...item, checked: false };\n        }\n        else {\n          setSelectedLineItem([...selectedLineItem, item]);\n          return { ...item, checked: true };\n        }\n      }\n      return item;\n    });\n\n    setLineItems(checkboxes);\n  };\n\n  const handleSelectAll = (e) => {\n    const checkedLineItems = lineItems.map(item => ({ ...item, checked: e.target.checked }));\n    if (e.target.checked) {\n      setSelectedLineItem(lineItems);\n    }\n    else {\n      setSelectedLineItem([]);\n    }\n    setLineItems(checkedLineItems);\n    setAllCheckboxSelected(e.target.checked);\n  };\n\n  useEffect(() => {\n    fetchNewLineItems(selectedClient, pageNumber, selectedOption).then(async res => {\n      setTotalLineItems(res.data.pagy.count);\n      setPageNumber(pageNumber + 1);\n      const items = res.data.new_line_item_entries.map(item => ({\n        ...item, checked: allCheckboxSelected,\n        lineTotal: (Number(item.qty) / 60 * Number(item.rate))\n      }));\n      const mergedItems = [...items, ...lineItems];\n      const sortedData = mergedItems.sort((item1, item2) => dayjs(item1.date).isAfter(dayjs(item2.date)) ? 1 : -1);\n      setLineItems(sortedData);\n    });\n  }, []);\n\n  const loadMore = () => {\n    fetchNewLineItems(selectedClient, pageNumber, selectedOption).then(async res => {\n      setTotalLineItems(res.data.pagy.count);\n      setPageNumber(pageNumber + 1);\n      const items = res.data.new_line_item_entries.map(item => ({\n        ...item,\n        checked: allCheckboxSelected,\n        lineTotal: (Number(item.qty) / 60 * Number(item.rate))\n      }));\n      const mergedItems = [...items, ...lineItems];\n      const sortedData = mergedItems.sort((item1, item2) => dayjs(item1.date).isAfter(dayjs(item2.date)) ? 1 : -1);\n      setLineItems(sortedData);\n      if (allCheckboxSelected) {\n        setSelectedLineItem(lineItems);\n      }\n    });\n  };\n\n  const handleSubmitModal = () => {\n    if (selectedLineItem.length > 0) {\n      setSelectedOption([...selectedOption, ...selectedLineItem]);\n      setMultiLineItemModal(false);\n    }\n  };\n\n  return (\n    <div style={{ background: \"rgba(29, 26, 49,0.6)\" }} className=\"px-52 py-20 w-full h-full fixed inset-0 flex justify-center z-50\">\n      <div className=\"bg-white rounded-lg w-full h-128 flex flex-col justify-between\">\n        <Header\n          setMultiLineItemModal={setMultiLineItemModal}\n        />\n        <div className='mx-6'>\n          {lineItems.length > 0 && <Table\n            lineItems={lineItems}\n            loadMore={loadMore}\n            totalLineItems={totalLineItems}\n            pageNumber={pageNumber}\n            handleItemSelection={handleItemSelection}\n            handleSelectAll={handleSelectAll}\n            allCheckboxSelected={allCheckboxSelected}\n          />}\n        </div>\n        <Footer\n          selectedRowCount={selectedLineItem.length}\n          handleSubmitModal={handleSubmitModal}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default MultipleEntriesModal;\n"]},"metadata":{},"sourceType":"module"}